<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meu Jogo 3D - Primeira Pessoa</title>
    <style>
        body { margin: 0; overflow: hidden; font-family: sans-serif; }
        canvas { display: block; }

        /* Estilo dos Botões de Movimento */
        #controls {
            position: absolute;
            bottom: 20px;
            left: 20px;
            display: grid;
            grid-template-columns: repeat(3, 50px);
            grid-gap: 10px;
            z-index: 10;
        }
        .btn {
            width: 50px;
            height: 500px; /* Ajustado para visualização */
            width: 60px; height: 60px;
            background: rgba(255, 255, 255, 0.3);
            border: 2px solid white;
            border-radius: 10px;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            user-select: none;
            cursor: pointer;
            font-weight: bold;
        }
        .btn:active { background: rgba(255, 255, 255, 0.6); }
        #up { grid-column: 2; }
        #left { grid-column: 1; }
        #down { grid-column: 2; }
        #right { grid-column: 3; }
        
        #instructions {
            position: absolute;
            top: 10px;
            width: 100%;
            text-align: center;
            color: white;
            pointer-events: none;
        }
    </style>
</head>
<body>

    <div id="instructions">Use as setas, WASD ou os botões na tela</div>
    
    <div id="controls">
        <div id="up" class="btn">W</div>
        <div id="left" class="btn">A</div>
        <div id="down" class="btn">S</div>
        <div id="right" class="btn">D</div>
    </div>

    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.160.0/build/three.module.js"
            }
        }
    </script>

    <script type="module">
        import * as THREE from 'three';

        // --- Configuração Básica ---
        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0x87ceeb); // Céu azul

        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);

        // --- Luz ---
        const light = new THREE.HemisphereLight(0xffffff, 0x444444, 1.5);
        scene.add(light);

        // --- Chão (Grid) ---
        const planeSize = 100;
        const loader = new THREE.TextureLoader();
        const floorGeom = new THREE.PlaneGeometry(planeSize, planeSize);
        const floorMat = new THREE.MeshPhongMaterial({ color: 0x228B22, side: THREE.DoubleSide });
        const floor = new THREE.Mesh(floorGeom, floorMat);
        floor.rotation.x = -Math.PI / 2;
        scene.add(floor);

        const grid = new THREE.GridHelper(planeSize, 20, 0x000000, 0x555555);
        scene.add(grid);

        // --- Jogador (Câmera) ---
        camera.position.y = 1.6; // Altura dos olhos

        // --- Lógica de Movimento ---
        const moveSpeed = 0.1;
        const keys = { w: false, a: false, s: false, d: false };

        // Listeners de Teclado
        window.addEventListener('keydown', (e) => keys[e.key.toLowerCase()] = true);
        window.addEventListener('keyup', (e) => keys[e.key.toLowerCase()] = false);

        // Listeners dos Botões na Tela
        const setupBtn = (id, key) => {
            const btn = document.getElementById(id);
            btn.addEventListener('mousedown', () => keys[key] = true);
            btn.addEventListener('mouseup', () => keys[key] = false);
            btn.addEventListener('touchstart', (e) => { e.preventDefault(); keys[key] = true; });
            btn.addEventListener('touchend', () => keys[key] = false);
        };

        setupBtn('up', 'w');
        setupBtn('left', 'a');
        setupBtn('down', 's');
        setupBtn('right', 'd');

        // --- Loop de Animação ---
        function animate() {
            requestAnimationFrame(animate);

            // Movimentação simples (Z e X)
            if (keys.w) camera.position.z -= moveSpeed;
            if (keys.s) camera.position.z += moveSpeed;
            if (keys.a) camera.position.x -= moveSpeed;
            if (keys.d) camera.position.x += moveSpeed;

            renderer.render(scene, camera);
        }

        // Ajuste de Janela
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

        animate();
    </script>
</body>
</html>
